### **Laravel의 동작 순서와 디렉토리 참고 순서**

#### 1. **`public/index.php` - 요청 시작점**

- 모든 HTTP 요청은 Laravel의 `public/index.php` 파일에서 시작됩니다.
- 이 파일은 Laravel 애플리케이션의 진입점(entry point)이며, 요청을 처리하기 위해 필요한 모든 초기화를 수행합니다.
- 주요 작업:
    - Composer의 자동 로더(`vendor/autoload.php`)를 로드합니다.
    - Laravel 애플리케이션 인스턴스를 생성합니다.
    - 요청을 처리하고 응답을 반환합니다.

---

#### 2. **`bootstrap/app.php` - 애플리케이션 초기화**

- `index.php`에서 `bootstrap/app.php` 파일을 호출하여 애플리케이션을 초기화합니다.
- 이 파일은 Laravel의 핵심 서비스 컨테이너를 생성하고, 필요한 설정을 로드합니다.
- 애플리케이션이 실행될 때 필요한 설정과 초기화를 수행하는 스크립트
- 이 파일은 Laravel 애플리케이션의 부트스트랩 과정(초기화 과정)을 정의하며, 요청이 들어올 때마다 실행
- 웹서버(apache, nginx 등)가 요청을 처리할 때, public/index.php 파일이 실행되며, 이 과정에서 bootstrap/app.php 가 호출
- php의 stateless 특성에서 기인
- 역할
	- 서비스 컨테이너 생성
	- 환경 설정 로드
	- 서비스 제공자 등록
	- 애플리케이션 반환
- 주요 작업:
    - 서비스 제공자(Service Providers)를 등록합니다.
    - 애플리케이션의 환경 설정을 초기화합니다.


```php
/* 1. 서비스 컨테이너 생성
Illuminate\Foundation\Application : 라라벨 핵심 애플리케이션 클래스
laravel 애플리케이션의 핵심인 '$app' 객체 생성
이 객체는 서비스 컨테이너로, 애플리케이션의 모든 구성 요소 관리
*/

// 
$app = new Illuminate\Foundation\Application(
$_ENV['APP_BASE_PATH'] ?? dirname(__DIR__)
);

// Http 커널 싱글톤(http 요청 처리) 서비스 컨테이너에 등록
$app->singleton(
Illuminate\Contracts\Http\Kernel::class,
App\Http\Kernel::class
);

// 콘솔 커널 싱글톤(콘솔 명령어 처리) 서비스 컨테이너에 등록
$app->singleton(
Illuminate\Contracts\Console\Kernel::class,
App\Console\Kernel::class
);

// 예외처리 싱글톤 서비스 컨테이너에 등록
$app->singleton(
Illuminate\Contracts\Debug\ExceptionHandler::class,
App\Exceptions\Handler::class
);
```



---

#### 3. **`app/Http/Kernel.php` - HTTP 커널**

- `bootstrap/app.php`에서 HTTP 커널(`app/Http/Kernel.php`)을 호출합니다.
- HTTP 커널은 애플리케이션의 요청-응답 사이클을 관리합니다.
- Laravel의 HTTP Kernel은 **하나의 프로세스**라기보다는, **하나의 클래스**로 정의된 애플리케이션의 중심적인 요청 처리 메커니즘입니다. 이 클래스는 요청(Request)을 받아 응답(Response)을 반환하는 역할
- 주요 작업:
    - 글로벌 미들웨어를 실행합니다.
    - 라우트 미들웨어를 실행합니다.
    - 요청을 컨트롤러로 전달합니다.
- spring의 DispatcherServlet과 비교되는 개념





[laravel HTTP Kernel 요청 처리 흐름]
1. **요청이 들어옴**: 클라이언트(브라우저, 앱 등)가 서버에 요청을 보냅니다.
2. **`public/index.php`에서 시작**: 모든 요청은 `index.php` 파일에서 시작됩니다.
3. **HTTP Kernel 호출**: `app/Http/Kernel.php`가 요청을 처리합니다.
    - 미들웨어를 실행하여 요청을 검증하거나 수정합니다.
    - 요청을 적절한 컨트롤러로 전달합니다.
4. **응답 반환**: 컨트롤러에서 생성된 응답이 HTTP Kernel을 통해 클라이언트로 반환됩니다.

[실제 동작 상태를 확인하는 요약 방법]

- **로그 파일**: `storage/logs/laravel.log`에서 요청 처리 상태를 확인.
- **미들웨어**: 요청과 응답을 로깅하여 HTTP Kernel의 동작을 추적.
- **Debugbar 또는 Telescope**: 요청 처리 흐름을 시각적으로 확인.
- **코드 분석**: `public/index.php`와 `app/Http/Kernel.php`를 살펴보고 요청-응답 흐름을 이해.

---

#### 4. **`routes/` - 라우트 정의**

- HTTP 커널은 요청 URL에 따라 적절한 라우트를 찾습니다.
- 라우트는 `routes/web.php` 또는 `routes/api.php` 파일에 정의됩니다.
    - `routes/web.php`: 웹 인터페이스를 위한 라우트 정의.
    - `routes/api.php`: API 요청을 위한 라우트 정의.
- 라우트는 요청을 처리할 컨트롤러 또는 클로저를 지정합니다.

---

#### 5. **`app/Http/Controllers/` - 컨트롤러**

- 라우트에서 지정된 컨트롤러를 호출합니다.
- 컨트롤러는 요청 데이터를 처리하고, 필요한 작업을 수행한 뒤 응답을 반환합니다.
- 컨트롤러 파일은 기본적으로 `app/Http/Controllers/` 디렉토리에 위치합니다.
    - 예: `app/Http/Controllers/AuthAPIController.php`

---

#### 6. **`app/Models/` - 모델**

- 컨트롤러에서 데이터베이스 작업이 필요한 경우, 모델을 호출합니다.
- 모델은 데이터베이스와 상호작용하며, Laravel의 Eloquent ORM을 사용합니다.
- 모델 파일은 기본적으로 `app/Models/` 디렉토리에 위치합니다.
    - 예: `app/Models/User.php`

---

#### 7. **`database/` - 데이터베이스**

- 모델이 데이터베이스와 상호작용할 때, `database/migrations/` 디렉토리에서 정의된 테이블 구조를 참조합니다.
- 데이터베이스 작업은 `config/database.php` 파일에서 설정된 연결 정보를 사용합니다.

---

#### 8. **`resources/` - 뷰 파일**

- 컨트롤러가 HTML 응답을 반환할 경우, 뷰 파일을 로드합니다.
- 뷰 파일은 기본적으로 `resources/views/` 디렉토리에 위치합니다.
    - 예: `resources/views/welcome.blade.php`
- Laravel의 Blade 템플릿 엔진을 사용하여 뷰를 렌더링합니다.

---

#### 9. **`config/` - 설정 파일**

- 애플리케이션의 모든 설정은 `config/` 디렉토리에 저장됩니다.
- 주요 설정 파일:
    - `config/app.php`: 애플리케이션의 기본 설정.
    - `config/database.php`: 데이터베이스 연결 설정.
    - `config/mail.php`: 이메일 설정.
    - `config/auth.php`: 인증 설정.

---

#### 10. **`storage/` - 캐시 및 로그**

- 애플리케이션의 캐시, 로그, 세션 데이터는 `storage/` 디렉토리에 저장됩니다.
- 주요 서브 디렉토리:
    - `storage/logs/`: 애플리케이션 로그 파일.
    - `storage/framework/cache/`: 캐시 데이터.
    - `storage/framework/sessions/`: 세션 데이터.

---

#### 11. **`vendor/` - Composer 패키지**

- Laravel은 Composer를 사용하여 외부 패키지를 관리합니다.
- 모든 패키지는 `vendor/` 디렉토리에 저장됩니다.
- 주요 패키지:
    - `laravel/framework`: Laravel의 핵심 프레임워크.
    - `phpoffice/phpspreadsheet`: CSV 및 Excel 파일 처리 패키지.

---

#### 12. **`app/Providers/` - 서비스 제공자**

- 서비스 제공자는 애플리케이션의 주요 기능을 등록하고 초기화합니다.
- 서비스 제공자 파일은 기본적으로 `app/Providers/` 디렉토리에 위치합니다.
    - 예: `app/Providers/AppServiceProvider.php`

---

#### 13. **`app/Console/` - Artisan 명령어**

- Artisan 명령어는 `app/Console/` 디렉토리에 정의됩니다.
- 개발자는 커스텀 명령어를 생성하여 작업을 자동화할 수 있습니다.

---

#### 14. **`tests/` - 테스트**

- 애플리케이션의 테스트는 `tests/` 디렉토리에 저장됩니다.
- Laravel은 PHPUnit을 사용하여 테스트를 실행합니다.

---

### **디렉토리 참고 순서 요약**

Laravel은 요청을 처리할 때 다음 순서로 디렉토리를 참조합니다:

1. `public/` - 요청 시작점.
2. `bootstrap/` - 애플리케이션 초기화.
3. `routes/` - 라우트 정의.
4. `app/Http/Controllers/` - 컨트롤러.
5. `app/Models/` - 모델.
6. `database/` - 데이터베이스.
7. `resources/` - 뷰 파일.
8. `config/` - 설정 파일.
9. `storage/` - 캐시 및 로그.
10. `vendor/` - Composer 패키지.

---

### **결론**

Laravel은 요청을 처리하기 위해 특정 디렉토리를 순차적으로 참조합니다. 이 구조는 PSR-4 자동 로딩 규칙과 Laravel의 MVC 패턴에 기반하며, 개발자가 애플리케이션의 동작을 쉽게 이해하고 확장할 수 있도록 설계되었습니다.